## Задание 8

### Создание сети
`docker network create backend-network` 

### Проверка созданной сети
`docker network ls` - просмотр списка сетей
```
NETWORK ID     NAME              DRIVER    SCOPE
0823c404bd49   backend-network   bridge    local
c12b0c939f07   bridge            bridge    local
f6e66e90ba72   host              host      local
f8abe09a6805   none              null      local
```

`docker network inspect backend-network` - детали сети

### Запуск контейнера с подключением к сети
`docker run -d --name redis-net --net=backend-network redis`

`docker run --rm --net=backend-network alpine ping -c 2 redis-net` - проверка подключения к redis (пинг)
```
PING redis-net (172.18.0.2): 56 data bytes
64 bytes from 172.18.0.2: seq=0 ttl=64 time=0.054 ms
64 bytes from 172.18.0.2: seq=1 ttl=64 time=0.055 ms

--- redis-net ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max = 0.054/0.054/0.055 ms
```

### Проверяем что не назначаются переменные сети и не обновляется файл host

```
ark@Ubuntu:~/MyCode/Oblaca_Docker/task9$ docker run --rm --net=backend-network alpine env
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
HOSTNAME=cf9a9af2f42a
HOME=/root
ark@Ubuntu:~/MyCode/Oblaca_Docker/task9$ docker run --rm --net=backend-network alpine cat /etc/hosts
127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::	ip6-localnet
ff00::	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
172.18.0.3	10d58c4017ed
```

### Проверяем назначение dns в файле resolv.conf
`docker run --rm --net=backend-network alpine cat /etc/resolv.conf`
```
# Generated by Docker Engine.
# This file can be edited; Docker Engine will not make further changes once it
# has been modified.

nameserver 127.0.0.11
search .
options edns0 trust-ad ndots:0

# Based on host file: '/etc/resolv.conf' (internal resolver)
# ExtServers: [host(127.0.0.53)]
# Overrides: []
# Option ndots from: internal
```

### Создаем новую сеть и подключаем redis к ней
`docker network create frontend-network`

`docker network connect frontend-network redis-net`

### Разворачиваем приложение с пробросом порта 
```
From parent_t5
EXPOSE 3002
```
`docker build -t network-app .`

`docker run -d --name node-app --net=frontend-network -p 3003:3002 network-app`

### Тест работы приложения
```
curl http://localhost:3003/
<h1>Hello!</h1><p>Visited 3 times.</p>
ark@Ubuntu:~/MyCode/Oblaca_Docker/task9$ curl http://localhost:3003/
<h1>Hello!</h1><p>Visited 4 times.</p>
ark@Ubuntu:~/MyCode/Oblaca_Docker/task9$ curl http://localhost:3003/
<h1>Hello!</h1><p>Visited 5 times.</p>
```

### Создание сети и подключение к ней redis с использованием псевдонима
`docker network create frontend-network2`
`docker network connect --alias db frontend-network2 redis-net`

### подключение нового контейнера к redis в новой сети + тест связи
```
...
const client = redis.createClient(6379, 'db'); 
...
```

```
curl http://localhost:3004/
<h1>Hello!</h1><p>Visited 1 times.</p>

ark@Ubuntu:~/MyCode/Oblaca_Docker/task9_aliasApp$ curl http://localhost:3004/
<h1>Hello!</h1><p>Visited 2 times.</p>

ark@Ubuntu:~/MyCode/Oblaca_Docker/task9_aliasApp$ curl http://localhost:3004/
<h1>Hello!</h1><p>Visited 3 times.</p>
```

### Отключаем redis от сети front... и проверяем работу приложения node.js
`docker network disconnect frontend-network redis-net`

```
rk@Ubuntu:~/MyCode/Oblaca_Docker/task9_aliasApp$ curl http://localhost:3003/
curl: (52) Empty reply from server
```